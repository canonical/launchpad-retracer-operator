name: launchpad-retracer
type: charm
title: Launchpad retracer charm
summary: Retrace crash reports submitted to Launchpad
description: |
  **Launchpad retracer Operator** is a [charm](https://juju.is/charms-architecture)
  for retracing launchpad reports.


links:
  website:
    - https://charmhub.io/launchpad-retracer
  issues:
    - https://github.com/canonical/launchpad-retracer-operator/issues
  source:
    - https://github.com/canonical/launchpad-retracer-operator


base: ubuntu@24.04
platforms:
  amd64:

parts:
  launchpad-retracer-charm:
    source: .
    plugin: uv
    build-packages: [git]
    build-snaps: [astral-uv]
    override-build: |
      craftctl default  # Run the default build steps.
      git describe --always > $CRAFT_PART_INSTALL/version

charm-libs:
  - lib: operator_libs_linux.systemd
    version: "1"
  - lib: traefik_k8s.ingress
    version: "2"

config:
  options:
    launchpad-credentials-id:
        type: secret
        description: the id of the launchpad credentials secret
    architectures:
        type: string
        default: "amd64"
        description: space-separated list of architectures to run retracers for

requires:
  ingress:
    interface: ingress
    limit: 1